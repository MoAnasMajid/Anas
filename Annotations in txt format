#Installing ultralytics package on google colab to work with it's YOLOv8 model
!pip install ultralytics opencv-python-headless

import cv2
from ultralytics import YOLO

# Load the YOLOv8 model
model = YOLO('yolov8n.pt')

# Path to the input video file- this video contains the predictions made by the YOLOv8 model
video_path = '/content/output_video.mp4'

# Open the video file
cap = cv2.VideoCapture(video_path)

frame_id = 0
annotations = []

while cap.isOpened():
    ret, frame = cap.read()
    if not ret:
        break

    # Run YOLOv8 detection on the frame
    results = model(frame)

    # Process each detection
    for result in results:
        for detection in result.boxes.data:
            x1, y1, x2, y2, score, class_id = map(int, detection)
            bb_left = x1
            bb_top = y1
            bb_width = x2 - x1
            bb_height = y2 - y1
            conf = score
            x, y, z = -1, -1, -1

            # Construct the annotation line
            annotation_line = f"{frame_id}, {class_id}, {bb_left}, {bb_top}, {bb_width}, {bb_height}, {conf}, {x}, {y}, {z}\n"
            annotations.append(annotation_line)

    frame_id += 1

# Release the video capture
cap.release()

# Save the annotations to a text file
with open('annotations.txt', 'w') as f:
    f.writelines(annotations)

print("Annotations saved to annotations.txt")
