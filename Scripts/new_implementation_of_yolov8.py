# -*- coding: utf-8 -*-
"""new implementation of YOLOv8.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/159pTJ-oY3oBIsLbYq31fseeZSpnF7Cv_
"""

pip install ultralytics

from ultralytics import YOLO

# Load your model
model = YOLO("/content/yolov8n.pt")

# Set the tracker configuration
model.tracker = "ultralytics/cfg/trackers/bytetrack.yaml"

# Run tracking
results = model.track(source="/content/Input model.webm", conf=0.8, iou=0.6, show=True, save=True)

# Save results in MOTChallenge format (frame, id, bbox, conf)
with open('track_results.txt', 'w') as f:
    for frame_id, result in enumerate(results):
        for box in result.boxes:
            bbox = box.xyxy[0].tolist()  # Convert from tensor to list
            track_id = box.id.item()  # Get track id
            conf = box.conf.item()  # Get confidence score
            if track_id is not None:  # Ensure tracking ID is available
                f.write(f'{frame_id+1},{track_id},{bbox[0]},{bbox[1]},{bbox[2]-bbox[0]},{bbox[3]-bbox[1]},-1,-1,{conf}\n')
            else:
                print("Warning: Tracking ID is None for a box in frame", frame_id+1)